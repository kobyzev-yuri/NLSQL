# –ê–Ω–∞–ª–∏–∑ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –∫–∞—á–µ—Å—Ç–≤–∞ SQL –≤ —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π Ollama

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –æ—Ü–µ–Ω–∫–∏

–í –Ω–∞—à–µ–º —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å **5-–±–∞–ª–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ SQL** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–Ω—É—Å–æ–≤ –∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å.

## –î–µ—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ü–µ–Ω–∫–∏

### 1. –ë–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ)

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–π SQL
if not sql or not sql.strip():
    return 0

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞
if not sql_lower.startswith('select'):
    return 0
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ï—Å–ª–∏ SQL –ø—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `SELECT`, –æ—Ü–µ–Ω–∫–∞ = 0

### 2. –®—Ç—Ä–∞—Ñ—ã –∑–∞ –æ—à–∏–±–∫–∏

```python
penalty = 0

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã
if 'eqorders' in sql_lower or 'eqpayments' in sql_lower:
    penalty += 1
```

**–®—Ç—Ä–∞—Ñ—ã**:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü (`eqorders`, `eqpayments`) = -1 –±–∞–ª–ª

### 3. –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏

```python
# –ü—Ä–æ—Å—Ç–æ–π –±–∞–∑–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
if sql_lower == 'select * from equsers;':
    return 3  # –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
```

**–õ–æ–≥–∏–∫–∞**: –ü—Ä–æ—Å—Ç–æ–π `SELECT * FROM equsers` –ø–æ–ª—É—á–∞–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –æ—Ü–µ–Ω–∫—É 3/5

### 4. –ë–æ–Ω—É—Å—ã –∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å

```python
bonus = 0
if 'join' in sql_lower:        # +1 –∑–∞ JOIN
    bonus += 1
if 'group by' in sql_lower:    # +1 –∑–∞ GROUP BY
    bonus += 1
if 'where' in sql_lower:      # +1 –∑–∞ WHERE
    bonus += 1
if 'count(' in sql_lower or 'sum(' in sql_lower:  # +1 –∑–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏—é
    bonus += 1
```

**–ë–æ–Ω—É—Å—ã**:
- `JOIN` = +1 –±–∞–ª–ª
- `GROUP BY` = +1 –±–∞–ª–ª  
- `WHERE` = +1 –±–∞–ª–ª
- –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (`COUNT`, `SUM`) = +1 –±–∞–ª–ª

### 5. –ò—Ç–æ–≥–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞

```python
return max(0, 5 - penalty + bonus)
```

**–§–æ—Ä–º—É–ª–∞**: `max(0, 5 - —à—Ç—Ä–∞—Ñ—ã + –±–æ–Ω—É—Å—ã)`

## –ü—Ä–∏–º–µ—Ä—ã –æ—Ü–µ–Ω–∫–∏ –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å (mistral:7b)
```sql
SELECT * FROM equsers;
```
- **–ë–∞–∑–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞**: 5
- **–®—Ç—Ä–∞—Ñ—ã**: 0
- **–ë–æ–Ω—É—Å—ã**: 0
- **–ò—Ç–æ–≥**: 5 - 0 + 0 = 5, –Ω–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π ‚Üí **3 –±–∞–ª–ª–∞**

### –ü—Ä–∏–º–µ—Ä 2: –°–ª–æ–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å JOIN (mistral:7b)
```sql
SELECT e.id, e.login, ed.name AS department_name
FROM equsers e
JOIN eq_departments ed ON e.department = ed.id;
```
- **–ë–∞–∑–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞**: 5
- **–®—Ç—Ä–∞—Ñ—ã**: 0
- **–ë–æ–Ω—É—Å—ã**: +1 (JOIN) + 1 (WHERE –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –Ω–æ –µ—Å—Ç—å JOIN)
- **–ò—Ç–æ–≥**: 5 - 0 + 1 = **6 –±–∞–ª–ª–æ–≤**

### –ü—Ä–∏–º–µ—Ä 3: –û—á–µ–Ω—å —Å–ª–æ–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å (mistral:7b)
```sql
SELECT 
    d.name, 
    COUNT(u.id) AS num_users, 
    COUNT(DISTINCT u.department) AS unique_departments,
    AVG(CASE WHEN u.deleted THEN 0 ELSE 1 END) AS avg_user_status
FROM 
    equsers u
JOIN 
    eq_departments d ON u.department = d.id
WHERE 
    u.deleted IS FALSE
GROUP BY 
    d.name, d.code
ORDER BY 
    num_users DESC;
```
- **–ë–∞–∑–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞**: 5
- **–®—Ç—Ä–∞—Ñ—ã**: 0
- **–ë–æ–Ω—É—Å—ã**: +1 (JOIN) + 1 (GROUP BY) + 1 (WHERE) + 1 (COUNT)
- **–ò—Ç–æ–≥**: 5 - 0 + 4 = **9 –±–∞–ª–ª–æ–≤**

### –ü—Ä–∏–º–µ—Ä 4: –ó–∞–ø—Ä–æ—Å —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
```sql
SELECT * FROM eqorders WHERE creationdatetime >= NOW() - INTERVAL '1 month';
```
- **–ë–∞–∑–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞**: 5
- **–®—Ç—Ä–∞—Ñ—ã**: +1 (eqorders –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- **–ë–æ–Ω—É—Å—ã**: +1 (WHERE)
- **–ò—Ç–æ–≥**: 5 - 1 + 1 = **5 –±–∞–ª–ª–æ–≤**

## –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –º–æ–¥–µ–ª—è–º

### üèÜ sqlcoder:latest (7.0/5)
- **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã**: –°–æ–∑–¥–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ JOIN
- **–ü—Ä–∏–º–µ—Ä—ã –≤—ã—Å–æ–∫–∏—Ö –æ—Ü–µ–Ω–æ–∫**: 8-9 –±–∞–ª–ª–æ–≤ –∑–∞ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- **–ü—Ä–æ–±–ª–µ–º—ã**: –ò–Ω–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã

### ü•à llama3:latest (6.8/5)  
- **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã**: –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, —Ö–æ—Ä–æ—à–∏–µ JOIN
- **–ü—Ä–∏–º–µ—Ä—ã**: 6-8 –±–∞–ª–ª–æ–≤ –∑–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ü—Ä–æ–±–ª–µ–º—ã**: –ú–µ–Ω–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏

### ü•â qwen3:8b (6.6/5)
- **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã**: –•–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏
- **–ü—Ä–∏–º–µ—Ä—ã**: 6-7 –±–∞–ª–ª–æ–≤ –∑–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ü—Ä–æ–±–ª–µ–º—ã**: –ò–Ω–æ–≥–¥–∞ –ø—Ä–æ—Å—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è

### ‚ö° qwen2.5-coder:1.5b (6.4/5)
- **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã**: –û—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π, —Ö–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è —Ä–∞–∑–º–µ—Ä–∞
- **–ü—Ä–∏–º–µ—Ä—ã**: 5-7 –±–∞–ª–ª–æ–≤
- **–ü—Ä–æ–±–ª–µ–º—ã**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏–∑-–∑–∞ —Ä–∞–∑–º–µ—Ä–∞ –º–æ–¥–µ–ª–∏

### üêå mistral:7b (5.8/5)
- **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã**: –•–æ—Ä–æ—à–∏–µ –±–∞–∑–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- **–ü—Ä–∏–º–µ—Ä—ã**: 3-9 –±–∞–ª–ª–æ–≤ (–±–æ–ª—å—à–æ–π —Ä–∞–∑–±—Ä–æ—Å)
- **–ü—Ä–æ–±–ª–µ–º—ã**: –ú–µ–¥–ª–µ–Ω–Ω—ã–π, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –æ—Ü–µ–Ω–∫–∏

### 1. –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
- –°–∏—Å—Ç–µ–º–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —Ä–µ—à–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É
- –¢–æ–ª—å–∫–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã

### 2. –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ª–æ–≥–∏–∫–∏ –≤ WHERE
- –ù–µ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞

### 3. –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à—Ç—Ä–∞—Ñ—ã
- –®—Ç—Ä–∞—Ñ –∑–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ –º–æ–¥–µ–ª—å –º–æ–≥–ª–∞ "–¥–æ–≥–∞–¥–∞—Ç—å—Å—è" –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

### 4. –ë–æ–Ω—É—Å—ã –Ω–µ –≤–∑–≤–µ—à–µ–Ω—ã
- JOIN –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è –æ—Ü–µ–Ω–∏–≤–∞—é—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ
- –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å JOIN'–æ–≤

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞
```python
# –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∑–∞–ø—Ä–æ—Å–∞ –≤–æ–ø—Ä–æ—Å—É
def check_semantic_relevance(sql, question):
    # –ê–Ω–∞–ª–∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –≤ –≤–æ–ø—Ä–æ—Å–µ vs SQL
    pass
```

### 2. –í–∑–≤–µ—à–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã
```python
# –°–ª–æ–∂–Ω—ã–µ JOIN'—ã –¥–æ–ª–∂–Ω—ã –æ—Ü–µ–Ω–∏–≤–∞—Ç—å—Å—è –≤—ã—à–µ
if 'join' in sql_lower:
    join_complexity = count_joins(sql)
    bonus += min(join_complexity, 3)  # –î–æ 3 –±–∞–ª–ª–æ–≤ –∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å JOIN
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ç–∏–≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º—ã –ë–î
def check_table_exists(table_name):
    return table_name in REAL_DB_SCHEMA
```

### 4. –û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```python
# –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –±—ã—Ç—å –ª—É—á—à–µ —Å–ª–æ–∂–Ω—ã—Ö
if is_simple_and_efficient(sql):
    bonus += 1
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è **—Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞** –º–æ–¥–µ–ª–µ–π, –Ω–æ –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è **–∞–±—Å–æ–ª—é—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞**. –û–Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ã—è–≤–ª—è–µ—Ç —Ä–∞–∑–ª–∏—á–∏—è –≤ –ø–æ–¥—Ö–æ–¥–∞—Ö –º–æ–¥–µ–ª–µ–π –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SQL, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç –∑–∞–º–µ–Ω–∏—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–Ω—É—é –æ—Ü–µ–Ω–∫—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.




